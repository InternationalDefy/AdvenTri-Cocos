发现一个问题：LaEmoji和Controller的按键监听没有swallow：也许在后续的UI层中解决该问题，毕竟LaEmoji理应只出现在UI层中。
现在需要考虑的是摄像机系统的构建。
将要实现的目的：
1：只对实体层和背景层生效，UI层无效。
2：支持对某一实体的跟随操作
3：可以通过函数调用使其变换位置
4：可以通过函数调用变换高度
5：在指定的位置停止行动
6：对不同层有不同的移动系数

先对Camera类进行考虑和研究：
1：Camera类属于Scene非Layer
2：Camera随移动可以用update里的setposition实现
3：Camera可以利用Layer类里设置_follow bool来控制其是否移动或者函数移动时将其置反
目前的问题：
1：MousePosition仍然时窗口位置，与实际位置设置的Position有差异（m_pctrl）
2：远近景问题。

解决方案：
1：在PCTRL类中加入ViewPostition类表示当前Entity在Layer中的Position，除了开始设置值之外，其它的函数也应当考虑到对其修改（也许应该改为Entity的属性？）。
2：mousePosition经过ViewPosition的设置得以正常，考虑到不只有Rotation要MousePosition，所以将其在Update里即时修改。
楼上部队，Update里即时修改会对一个mousepos进行无数次逻辑错误的修改，
替换解决方案：mousepos表示mouse在游戏世界里的实际位置，是一个每帧修正的量，而GLmouseview则表示mouse在窗口的位置，是一个改变监控量。

关于远近景问题：
1：设置每个实体和不同背景的PositionZ可以实现远近景的设置，具体的效果和数值设计应该可以计算。
2：遮挡只与Zorder有关，positionZ决定了远近景但是不会影响遮挡，所以Zorder和PositionZ设置要注意区分。
3：目前是实验类，需要考虑不同positionZ和Zorder具体应当在何处设置。
4：摄像机有一定的视距，超出了视距则会消失。

以下开始对Camera高度和PositionZ设置的定量探究。
先使用测试类探究CameraZ高度。
720P Z:622 1080P Z:933 1440P: Z:1245
基本上摸索清楚了摄像机机制。记录于图2.7

物理实体抖动问题十分严重：
1：实际上是更新方法没有使用缓冲模式导致的
2：1.6+引擎解决了抖动问题，但是impulse和force的设置乱得一塌糊涂切是接口无法修改。
3：0.4-版本没有抖动问题，但是相机机制不完善。
4：明天尝试使用4-版本，今天发现0.8版本可以通过修改更新频率使抖动明显降低。
5：但是修改更新频率会使CPU占有率明显提升。

不用明天尝试了，3.3版本OK，且可以使用摄像机机制，明天移植。

*****************
以上为7日日志
*****************

移植以后出现Camera类各种新问题
现在绝望中。。。原因：
1：3.09+版本物理引擎崩坏
2：3.04-3.08版本抖动严重
3：3.03-版本摄像机不完善

考虑的解决办法：
1：修改3.09+物理引擎：对不起，接口，改你马勒戈壁
2：修改3.03-版本中的摄像机类：不现实，考虑到太多OpenGl内容，及3.03-其摄像机模拟机制与+不同
3：（40%可行）使用b2D，由于Api和cp完全不同，和实体类的所属关系也完全不同，使用此法 1：需要学习一套完全不同的api 2：几乎重写所有实体类
4：（60%可行）尝试在3.08中修改更新方法。对比3.03-或3.09+实现

目前采用方法4：
发现mainloop中 3.08 3.03不同之处
1：.03有一个FreqInterval 
2：.08有重启Director操作
3：.03有一个跳过delta操作
4：.08update的time类可能有问题
5：.03对GLBUFFER的宏调用

.08里的experimentbuffer可能是罪魁祸首，欲删除之再尝试。

.13版本中有相同的问题，决定在其中进行源码修改，也可以考虑.04版本来考虑最近的修改。

3和4在物理更新上有很多逻辑上的不同和时间上的不同：
shape所使用的update方法其实一样，但是名字不同，实际都是在updatescale
body的update方法world的update方法不同：
1：
.03在body的更新中对
node position 
body position 
node scale 进行了步进更新
.04没有
2：
.03 .04world的update方法上没有区别
其共同作用：
1：body transferm
2：调用body update

经过一天近乎绝望的debug，终于发现是摄像机更新方法的位置不对
可以用两种方案解决：
1：runaction（有艺术效果，但需要考虑，Mpctrl中viewposition的重设）
2：updateFinish（要研究一下）
3：cameraphysics，都是Node，可以试试。
4！！！明天！！！

今天多做一些，帮明天枪毙掉方案3.方案1可以脚本实现。